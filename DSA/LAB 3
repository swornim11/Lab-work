#include <iostream>
#include <stack>
#include <string>
using namespace std;

int precedence(char op) {
    if (op == '^' || op =='$') 
	 return 3;
    if (op == '*' || op == '/' || op == '%')
	 return 2;
    if (op == '+' || op == '-')
	 return 1;
	 
    return 0;
}

bool isOperator(char c) {
    return (c == '+' || c == '-' || c == '*' || c == '/' || c == '^' || c == '$' || c == '%');
}

void printStack(stack<char> st) {
    string temp = "";
    while (!st.empty()) {
        temp = st.top() + temp;
        st.pop();
    }
    cout << temp;
}

string infixToPostfix(const string& infix) {
    stack<char> st;
    string postfix;

    cout << "\nScanned\t\tPostfix\t\tOpStack\n";

    for (int i = 0; i < infix.length(); i++) {

        char ch = infix[i];

        if (isalnum(ch)) {
            postfix += ch;
        }

        else if (ch == '(') {
            st.push(ch);
        }

        else if (ch == ')') {
            while (!st.empty() && st.top() != '(') {
                postfix += st.top();
                st.pop();
            }
            st.pop();
        }

        else if (isOperator(ch)) {
            while (!st.empty() && precedence(st.top()) >= precedence(ch)) {
                postfix += st.top();
                st.pop();
            }
            st.push(ch);
        }

        // print table row
        cout << ch << "\t\t" << postfix << "\t\t";
        printStack(st);
        cout << "\n";
    }

    while (!st.empty()) { 
        postfix += st.top();
        st.pop();
    }
    return postfix;
}

int main() {
    string infix;
    cout << "=====Swornim Maharjan=====";
    cout << "\nEnter infix expression: ";
    cin >> infix;

    cout << "\nPostfix: " << infixToPostfix(infix) << endl;

    return 0;
}
